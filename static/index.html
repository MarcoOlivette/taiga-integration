<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Gerenciador de tarefas em massa para Taiga - Crie e edite m√∫ltiplas tarefas de forma eficiente"
    />
    <title>Taiga Bulk Task Manager</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="bulk-modal-styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="container">
        <div class="header-content">
          <h1 class="logo">
            <svg
              class="logo-icon"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
            >
              <path
                d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"
              />
            </svg>
            Taiga Bulk Manager
          </h1>
          <div class="user-info" id="userInfo" style="display: none">
            <div class="user-avatar" id="userAvatar"></div>
            <span class="user-name" id="userName"></span>
            <button
              class="btn-theme"
              id="themeToggleBtn"
              title="Alternar Tema"
              style="
                background: none;
                border: none;
                cursor: pointer;
                color: var(--text-secondary);
                padding: 5px;
                margin-right: 8px;
                border-radius: 50%;
                transition: all 0.2s;
              "
            >
              <svg
                class="theme-icon-light"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                style="width: 20px; height: 20px; display: block"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
                />
              </svg>
              <svg
                class="theme-icon-dark"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                style="width: 20px; height: 20px; display: none"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
                />
              </svg>
            </button>
            <button class="btn-logout" id="logoutBtn">Sair</button>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <div class="container">
        <!-- Login Screen -->
        <div class="screen active" id="loginScreen">
          <div class="login-card">
            <div class="login-header">
              <h2>Conectar ao Taiga</h2>
              <p>Fa√ßa login para gerenciar suas tarefas</p>
            </div>
            <form id="loginForm" class="login-form">
              <div class="form-group">
                <label for="taigaUrl">URL do Taiga</label>
                <input
                  type="url"
                  id="taigaUrl"
                  placeholder="https://api.taiga.io/api/v1"
                  required
                />
                <small
                  >URL da API do seu Taiga (ex:
                  https://api.taiga.io/api/v1)</small
                >
              </div>
              <div class="form-group">
                <label for="username">Usu√°rio ou Email</label>
                <input
                  type="text"
                  id="username"
                  placeholder="seu@email.com"
                  required
                />
              </div>
              <div class="form-group">
                <label for="password">Senha</label>
                <input
                  type="password"
                  id="password"
                  placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                  required
                />
              </div>
              <button type="submit" class="btn btn-primary btn-large">
                <span class="btn-text">Conectar</span>
                <div class="spinner" style="display: none"></div>
              </button>
              <div
                class="error-message"
                id="loginError"
                style="display: none"
              ></div>
            </form>
          </div>
        </div>

        <!-- Projects Screen -->
        <div class="screen" id="projectsScreen">
          <div class="screen-header">
            <h2>Meus Projetos</h2>
            <p>Selecione um projeto para gerenciar tarefas</p>
          </div>
          <div class="search-box">
            <svg
              class="search-icon"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
            >
              <circle cx="11" cy="11" r="8" />
              <path d="m21 21-4.35-4.35" />
            </svg>
            <input
              type="text"
              id="projectSearch"
              placeholder="Buscar projetos..."
            />
          </div>
          <div class="projects-grid" id="projectsGrid">
            <!-- Projects will be loaded here -->
          </div>
        </div>

        <!-- User Stories Screen -->
        <div class="screen" id="userStoriesScreen">
          <div class="screen-header">
            <button class="btn-back" id="backToProjects">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M19 12H5M12 19l-7-7 7-7" />
              </svg>
              Voltar
            </button>
            <div>
              <h2 id="projectTitle">User Stories</h2>
              <p id="projectDescription">Selecione uma User Story ou √âpico</p>
            </div>
          </div>

          <div class="tabs">
            <button class="tab active" data-tab="userstories">
              User Stories
            </button>
            <button class="tab" data-tab="epics">√âpicos</button>
          </div>

          <div class="search-box">
            <svg
              class="search-icon"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
            >
              <circle cx="11" cy="11" r="8" />
              <path d="m21 21-4.35-4.35" />
            </svg>
            <input
              type="text"
              id="usSearch"
              placeholder="Buscar user stories ou √©picos..."
            />
          </div>

          <div class="tab-content active" id="userStoriesTab">
            <div class="stories-list" id="storiesList">
              <!-- User stories will be loaded here -->
            </div>
          </div>

          <div class="tab-content" id="epicsTab">
            <div class="stories-list" id="epicsList">
              <!-- Epics will be loaded here -->
            </div>
          </div>
        </div>

        <!-- Tasks Screen -->
        <div class="screen" id="tasksScreen">
          <div class="screen-header">
            <button class="btn-back" id="backToStories">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M19 12H5M12 19l-7-7 7-7" />
              </svg>
              Voltar
            </button>
            <div>
              <h2 id="storyTitle">Tarefas</h2>
              <p id="storyDescription">Gerencie tarefas em massa</p>
            </div>
          </div>

          <div class="tasks-actions">
            <button class="btn btn-primary" id="addTaskBtn">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M12 5v14M5 12h14" />
              </svg>
              Adicionar Tarefa
            </button>
            <button class="btn btn-info" id="bulkAddBtn">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path
                  d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"
                />
                <polyline points="14 2 14 8 20 8" />
                <line x1="16" y1="13" x2="8" y2="13" />
                <line x1="16" y1="17" x2="8" y2="17" />
                <polyline points="10 9 9 9 8 9" />
              </svg>
              Cria√ß√£o em Massa
            </button>
            <button class="btn btn-secondary" id="reloadTasksBtn">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M1 4v6h6M23 20v-6h-6" />
                <path
                  d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"
                />
              </svg>
              Atualizar
            </button>
            <button
              class="btn btn-success"
              id="saveAllTasksBtn"
              style="display: none"
            >
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path
                  d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"
                />
                <polyline points="17 21 17 13 7 13 7 21" />
                <polyline points="7 3 7 8 15 8" />
              </svg>
              Salvar Tudo
            </button>
          </div>

          <div class="bulk-assign-section">
            <div class="bulk-label">
              <div class="bulk-icon-wrapper">
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  style="width: 20px; height: 20px; stroke-width: 2"
                >
                  <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"></path>
                  <circle cx="9" cy="7" r="4"></circle>
                  <path d="M23 21v-2a4 4 0 00-3-3.87"></path>
                  <path d="M16 3.13a4 4 0 010 7.75"></path>
                </svg>
              </div>
              Atribui√ß√£o em Massa
            </div>
            <div class="bulk-controls">
              <div id="bulkAssignMemberContainer">
                <!-- Populated via JS -->
              </div>
              <button
                class="btn btn-primary"
                id="applyBulkAssignBtn"
                title="Atribuir este usu√°rio a todas as tarefas listadas"
              >
                Vincular a Todos
              </button>
            </div>
          </div>

          <div class="bulk-assign-section" style="margin-top: 1.5rem">
            <div class="bulk-label">
              <div
                class="bulk-icon-wrapper"
                style="
                  color: var(--warning);
                  background: rgba(245, 158, 11, 0.1);
                "
              >
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  style="width: 20px; height: 20px; stroke-width: 2"
                >
                  <path d="M9 11l3 3L22 4"></path>
                  <path
                    d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"
                  ></path>
                </svg>
              </div>
              Status em Massa
            </div>
            <div class="bulk-controls">
              <div id="bulkStatusContainer" style="flex: 1">
                <!-- Populated via JS -->
              </div>
              <button
                class="btn btn-primary"
                id="applyBulkStatusBtn"
                style="
                  background-color: var(--warning);
                  border-color: var(--warning);
                  color: white;
                "
                title="Aplicar status a todas as tarefas"
              >
                Alterar Status
              </button>
            </div>
          </div>

          <!-- Bulk Creation Modal -->
          <div class="bulk-modal" id="bulkModal" style="display: none">
            <div class="bulk-modal-content">
              <div class="bulk-modal-header">
                <h3>üìù Cria√ß√£o em Massa de Tarefas</h3>
                <button class="bulk-modal-close" id="closeBulkModal">
                  &times;
                </button>
              </div>
              <div class="bulk-modal-body">
                <p class="bulk-instructions">
                  Digite cada tarefa em uma linha separada. Cada linha ser√°
                  criada como uma tarefa individual.
                </p>
                <textarea
                  id="bulkTasksInput"
                  class="bulk-textarea"
                  placeholder="Tarefa 1&#10;Tarefa 2&#10;Tarefa 3&#10;..."
                  rows="15"
                ></textarea>
                <div class="bulk-preview">
                  <span id="bulkTaskCount">0 tarefas</span> ser√£o criadas
                </div>
              </div>
              <div class="bulk-modal-footer">
                <button class="btn btn-secondary" id="cancelBulkBtn">
                  Cancelar
                </button>
                <button class="btn btn-success" id="saveBulkBtn">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    style="width: 16px; height: 16px"
                  >
                    <path
                      d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"
                    />
                    <polyline points="17 21 17 13 7 13 7 21" />
                    <polyline points="7 3 7 8 15 8" />
                  </svg>
                  Criar Todas
                </button>
              </div>
            </div>
          </div>

          <div class="tasks-container" id="tasksContainer">
            <!-- Existing tasks will be loaded here -->
          </div>

          <div class="new-tasks-container" id="newTasksContainer">
            <!-- New tasks will be added here -->
          </div>
        </div>
      </div>
    </main>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Task Details Modal -->
    <div class="modal-overlay" id="taskDetailsModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="modalTaskTitle">Detalhes da Tarefa</h3>
          <button class="modal-close" id="closeTaskModal">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M18 6L6 18M6 6l12 12" />
            </svg>
          </button>
        </div>
        <div class="modal-body" id="modalTaskBody">
          <!-- Task details will be loaded here -->
        </div>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
      <div class="loading-spinner"></div>
      <p>Carregando...</p>
    </div>

    <script src="config.js"></script>
    <script src="api.js"></script>
    <script src="app.js"></script>
  </body>
</html>
